//shows address of environment variables on the stack of whatever program you want
//Extremely useful for buffer overflows (especially if the server has aslr enabled)
//I stole this from Hacking: the art of exploitation second edition
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main(int argc, char *argv[]) {
	char *ptr;

	if (argc < 3) {
		printf("Usage: %s <environment var> <target program name>\n", argv[0]);
		exit(0);
	}
	//grab the environment variable (your shellcode)
	ptr = getenv(argv[1]);
	//do some maths to figure out the address,
	//takes into account the length of the argv[0]'s name and length of target program's name
	ptr += (strlen(argv[0]) - strlen(argv[2]))*2;
	printf("%s will be at %p\n", argv[1], ptr);
	//to be completly honest, I need to reread how this works! lol
}
