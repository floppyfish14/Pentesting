#wrote for troll2 directory bruteforcing, could be useful elsewhere

from __future__ import print_function

import requests
from sys import argv,exit

#check a url for directories specified by wordlist
if len(argv) < 3:
    print("Usage: %s [url] [wordlist]" % argv[0])
    exit(0)

def read_wordlist(word_list):
    return [word for line in open(word_list, 'r') for word in line.rstrip('\n').split()] #reads lines of word_list and puts in array, strips newline characters

server = argv[1]

print("Showing dirs with 200 response code.")
for i in read_wordlist(argv[2]):
    url = server+i
    try:
        r = requests.get(url)
        if r.status_code == 200:
            print("%s"% i)
    except requests.exceptions.RequestException as e:
        print("%s"% e)
        exit(1)
