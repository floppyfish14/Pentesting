#!/usr/bin/env python

from socket import *
from itertools import permutations
from scapy.all import *
import time
import sys
import random
import os

def Knockports(ports):
    for port in ports:
        try:
            print("[*] Knocking on port: ", port )
            network_layer = IP(dst='192.168.56.101')
            transport_layer = TCP(sport=RandShort(), dport=int(port),flags="S")
            send(network_layer/transport_layer, verbose=False)
            print(str(port) + " Packet Sent")
        except:
            print("There was an error!")
        
def main(): 
    r = [7482,8279,9467]

    print("Trying permutations of: ", r)

    for comb in permutations(r):
        print("\n[*] Trying sequence %s" % str(comb))
        Knockports(comb)

    print("[*] Done")

main()
